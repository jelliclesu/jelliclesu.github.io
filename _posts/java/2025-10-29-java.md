---
title: "[Java] 일급 컬렉션 (First-Class Collection)"
date: 2025-10-29 17:29:14 +0900
categories: [매일메일, JAVA]
tags: [TIL, JAVA]
---
# 일급 컬렉션 (First-Class Collection)
## 일급 컬렉션

> 하나의 컬렉션(List, Set, Map 등)을 감싸는 전용 클래스를 만들어 그 안에서 컬렉션과 관련된 비즈니스 로직과 불변성 관리를 책임지게 하는 설계 패턴

ex) 단순 `List<Order>` 로 데이터를 다루지 않고, 이를 감싸는 `Orders` 라는 객체를 새로 만들어 역할과 의미 부여

---

## 예시 코드

```java
public class Orders {

    private final List<Order> orders;

    public Orders(List<Order> orders) {
        validate(orders); // 유효성 검증
        this.orders = new ArrayList<>(orders);
    }

    private void validate(List<Order> orders) {
        if (orders == null || orders.isEmpty()) {
            throw new IllegalArgumentException("주문 목록은 비어 있을 수 없습니다.");
        }
    }

    public void add(Order order) {
        if (order == null) {
            throw new IllegalArgumentException("Order는 null일 수 없습니다.");
        }
        orders.add(order);
    }

    public List<Order> getAll() {
        // 외부에서 컬렉션을 수정하지 못하도록 불변 리스트 반환
        return Collections.unmodifiableList(orders);
    }

    public double getTotalAmount() {
        return orders.stream()
                     .mapToDouble(Order::getAmount)
                     .sum();
    }
}
```

```java
@Service
public class OrderService {

    private final Orders orders = new Orders(List.of());

    public void addOrder(Order order) {
        orders.add(order);
    }

    public Orders getOrders() {
        return orders;
    }

    // 추가적인 비즈니스 로직...
}
```

---

## 특징 및 사용 이유

### 1. 컬렉션을 하나의 객체로 캡슐화
  - 단순 데이터 구조가 아닌, 의미 있는 도메인 객체로 관리 가능
### 2. 컬렉션 관련 비즈니스 로직 응집
  - 검증, 정렬, 필터링, 합계 계산 등 컬렉션과 관련된 모든 로직을 내부에 응집시켜 유지보수성 높임
### 3. 불변성 보장
  - `Collections.unmodifiableList()` 등 외부에서 컬렉션을 변경할 수 없게함
### 4. 불필요한 컬렉션 API 노출 방지
  - 외부에서 `List.add()`, `clear()` 같은 메서드의 직접 조작을 제한하고, 객체 내부에서 허용한 동작만 수행 가능
### 5. 검증 로직 일원화
  - 컬렉션 내부 요소에 대한 유효성 검사를 한 곳에서 수행해 중복 코드 제거 및 일관성 유지 가능

---

참고: [maeil-mail 매일메일 - 일급 컬렉션이 무엇인가요?](https://www.maeil-mail.kr/question/53)
