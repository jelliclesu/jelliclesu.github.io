---
title: "[CS] 인덱스: 인덱스 만드는 방법"
date: 2025-05-28 11:54:36 +0900
categories: [CS, 데이터베이스]
tags: [TIL, CS, 인덱스]
---
# CS 4장 데이터베이스
## 📚 4.5 인덱스

### 4.5.3 인덱스 만드는 방법

#### 📘 기본 개념
- 인덱스는 특정 컬럼에 대해 검색 성능을 높이기 위해 수동으로 생성할 수 있음
- SQL: `CREATE INDEX`
- JPA: `@Index` 사용

---

#### 📌 SQL 로 인덱스 생성
##### ⭐️ **기본 인덱스 생성**

```sql
CREATE INDEX idx_user_email
ON user(email);
```

- `user` 테이블의 `email` 컬럼에 인덱스 생성

--

##### ⭐️ **복합 인덱스 (Composite Index)**

```sql
CREATE INDEX idx_order_user_created
  ON orders(user_id, created_at);
```

- `user_id + created_at` 을 묶어서 인덱스
- 주의: **왼쪽부터 순서대로만 인덱스 사용됨** (`user_id` 만 OR `user_id + create_at` 만)

--

##### ⭐️ **UNIQUE 인덱스**
- 중복 방지

```sql
CREATE UNIQUE INDEX idx_user_nickname
  ON user(nickname);
```

- 중복된 `nickname` 입력 불가

--

##### ⭐ **인덱스 삭제 (Drop)**

```sql
DROP INDEX idx_user_email ON user;
```
---

#### 💻 Java/Spring 예시

##### ⭐️ **단일 인덱스**

```java
@Entity
@Table(name = "user", indexes = {
  @Index(name = "idx_email", columnList = "email")
})
public class User {
  @Id
  private Long id;

  private String email;
}
```


##### ⭐️ **복합 인덱스**

```java
@Entity
@Table(name = "orders", indexes = {
  @Index(name = "idx_user_created", columnList = "user_id, created_at")
})
public class Order {
  @Id
  private Long id;

  private Long userId;
  private LocalDateTime createdAt;
}
```

- `columnList` 에 순서대로 입력

---

#### 🏢 인덱스 설계 시 고려사항

- WHERE 절 자주 등장하는 컬럼
- ORDER BY 자주 등장하는 컬럼
- JOIN 시 기준 컬럼
- INSERT/UPDATE 많은 컬럼은 신중히

---

#### ⚠️ 주의할 점
- 복합 인덱스는 **왼쪽부터 순서대로 사용**되므로 순서 중요
- `LIKE` 검색 시 **접두어** (`LIKE 'A%'`) 만 인덱스 적용됨
- `IS NULL` 은 인덱스 적용되지만 경우에 따라 다름
- 너무 많은 인덱스는 오히려 성능 저하, 공간 차지

---

#### 🎤 면접 예상 질문
1. 복합 인덱스란 무엇이고 어떻게 사용하나요?
   - 여러 컬럼을 하나로 묶은 인덱스로, 왼쪽 우선 규칙이 적용됩니다.
   - 예를 들어 `user_id`, `created_at` 컬럼에 복합 인덱스를 만들면
   - `WHERE user_id = ?` 또는 `WHERE user_id = ? AND created_at = ?` 쿼리에만 적용되고,
   - `created_at` 만 사용하는 조건에는 적용되지 않습니다.
2. Spring JPA 에서는 인덱스를 어떻게 지정하나요?
   - `@Table(indexes = {@Index(...)})` 애노테이션을 통해 인덱스를 지정할 수 있습니다.
   - 실제로는 JPA 가 DDL 을 자동으로 생성하며, 스키마에 인덱스가 반영됩니다.
